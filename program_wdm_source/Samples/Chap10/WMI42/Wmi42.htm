<HTML>
<HEAD>
</HEAD>
<BODY>

<H2>The WMI42 Sample</H2>
<P>The WMI42 Sample accompanies Chapter 10 and illustrates the most basic WMI calls. The test procedure was revised in the 2d edition to use a scripting language instead
of C++.</P>
<P>The sample includes one component: WMI42.SYS is a WDM driver for a non-existent hardware device. </P>

<H3>Building WMI42</H3>
<P>To build WMI42.SYS, follow the <A HREF="../../wdmbook.htm#wdmbuild">general instructions for building a WDM sample</A>. The Microsoft Visual C++ project file is named WMI42.DSP in the SYS subdirectory.</P>

<H3>Testing WMI42</H3>
<P>Install the WMI42 "device." Follow the general instructions for using <A HREF="../../wdmbook.htm#fastinst">FastInst</A> in Windows XP or Windows 98/Me. The INF file is named WMI42.INF.</P>
<P>If you're testing in Windows 98/Me, please refer to the general instructions for <A HREF="../../wdmbook.htm#wmi98/Me">WMI in Windows 98/Me</A> for additional information.</P>
<P>Once you’ve installed WMI42, open a command prompt and launch TEST.VBS with the CSCRIPT command. It will read and report the current value of the Answer property. Then it will change the property value to be one higher. Successive invocations of TEST will print successively higher numbers.</P></BODY>

<h3>What to look for</h3>
<p>Look at the routines in <b>wmi.cpp</b> to see how to handle simple WMI requests.</p>

</HTML>
